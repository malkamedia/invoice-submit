<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor Invoice Form</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .invoice-container {
            max-width: 8.5in;
            min-height: 11in;
        }
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            .no-print {
                display: none !important;
            }
            .invoice-container {
                box-shadow: none !important;
                margin: 0 !important;
                max-width: 100%;
            }
        }
    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-6 lg:p-8">
    <div id="invoice-form" class="invoice-container mx-auto bg-white rounded-lg shadow-lg p-8 sm:p-12">
        <header class="flex justify-between items-start mb-10">
            <div>
                <h1 class="text-4xl font-bold text-gray-800">INVOICE</h1>
                <p class="text-gray-500 mt-2">Please fill out the details below.</p>
            </div>
            <div class="text-right md:w-1/2">
                <input id="vendor-name" type="text" placeholder="Vendor Company Name" class="w-full p-2 border rounded-md mb-2 focus:ring-2 focus:ring-blue-500 text-right font-semibold">
                <input id="vendor-address" type="text" placeholder="Vendor Address" class="w-full p-2 border rounded-md mb-2 focus:ring-2 focus:ring-blue-500 text-right">
                <input id="vendor-city" type="text" placeholder="City, State, ZIP" class="w-full p-2 border rounded-md mb-2 focus:ring-2 focus:ring-blue-500 text-right">
                <input id="vendor-email" type="email" placeholder="vendor.email@example.com" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500 text-right">
            </div>
        </header>

        <section class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10">
            <div>
                <h2 class="text-lg font-semibold text-gray-600 mb-2">Bill To:</h2>
                <input id="client-name" type="text" placeholder="Client Company Name" value="Malka Media Group" class="w-full p-2 border rounded-md mb-2 focus:ring-2 focus:ring-blue-500">
                <input id="hiring-manager" type="text" placeholder="Hiring Manager" class="w-full p-2 border rounded-md mb-2 focus:ring-2 focus:ring-blue-500">
                <input id="hiring-manager-email" type="email" placeholder="hiringmanager@malkamedia.com" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500">
            </div>
            <div class="text-right">
                <div class="flex justify-end items-center mb-2">
                    <label for="invoice-number" class="text-gray-600 font-semibold mr-2">Invoice #:</label>
                    <input type="text" id="invoice-number" placeholder="INV-12345" class="w-40 p-2 border rounded-md text-right focus:ring-2 focus:ring-blue-500" value="INV-001">
                </div>
                <div class="flex justify-end items-center mb-2">
                    <label for="invoice-date" class="text-gray-600 font-semibold mr-2">Invoice Date:</label>
                    <input type="date" id="invoice-date" class="w-40 p-2 border rounded-md text-right focus:ring-2 focus:ring-blue-500">
                </div>
                <div class="flex justify-end items-center mb-2">
                    <label for="pay-terms" class="text-gray-600 font-semibold mr-2">Pay Terms:</label>
                    <select id="pay-terms" class="w-40 p-2 border rounded-md text-right focus:ring-2 focus:ring-blue-500 bg-white">
                        <option>Due on Receipt</option>
                        <option>Net 15</option>
                        <option selected>Net 30</option>
                        <option>Net 45</option>
                        <option>Net 60</option>
                    </select>
                </div>
                <div class="flex justify-end items-center">
                    <label for="po-number" class="text-gray-600 font-semibold mr-2">PO# (If applicable):</label>
                    <input type="text" id="po-number" placeholder="Enter PO Number" class="w-40 p-2 border rounded-md text-right focus:ring-2 focus:ring-blue-500">
                </div>
            </div>
        </section>

        <section class="mb-10">
            <table class="w-full text-left">
                <thead>
                    <tr class="bg-gray-100 text-gray-600 uppercase text-xs">
                        <th class="p-2">Service / Item</th>
                        <th class="p-2 w-32">6 Digit Job Code</th>
                        <th class="p-2 w-20 text-center">Hours / QTY</th>
                        <th class="p-2 w-24 text-right">Rate</th>
                        <th class="p-2 w-28 text-right">Amount</th>
                        <th class="p-2 w-12 text-center no-print"></th>
                    </tr>
                </thead>
                <tbody id="invoice-items">
                    <!-- Item rows will be injected here by JavaScript -->
                </tbody>
            </table>
            <button id="add-item-btn" class="mt-4 bg-blue-500 text-white font-semibold py-2 px-4 rounded-md hover:bg-blue-600 transition duration-300 no-print">
                + Add Item
            </button>
        </section>

        <section class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <div class="md:col-span-1">
                 <h2 class="text-lg font-semibold text-gray-600 mb-2">Service Period:</h2>
                 <div class="space-y-2">
                    <div>
                        <label for="service-start" class="block text-sm font-medium text-gray-700">Service Start</label>
                        <input type="date" id="service-start" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div>
                        <label for="service-end" class="block text-sm font-medium text-gray-700">Service End</label>
                        <input type="date" id="service-end" class="w-full p-2 border rounded-md focus:ring-2 focus:ring-blue-500">
                    </div>
                </div>
            </div>
            <div class="md:col-span-2 flex justify-end">
                <div class="w-full max-w-xs">
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-gray-600 font-semibold">Subtotal:</span>
                        <span id="subtotal" class="font-bold text-gray-800">$0.00</span>
                    </div>
                    <div class="flex justify-between items-center mb-3">
                        <span class="text-gray-600 font-semibold">Tax (%):</span>
                        <input type="number" id="tax-rate" value="0" min="0" class="w-20 p-1 border rounded-md text-right focus:ring-2 focus:ring-blue-500">
                    </div>
                     <div class="border-t my-2"></div>
                    <div class="flex justify-between items-center mt-3">
                        <span class="text-2xl font-bold text-gray-800">Total:</span>
                        <span id="grand-total" class="text-2xl font-bold text-gray-800">$0.00</span>
                    </div>
                </div>
            </div>
        </section>

        <footer class="mt-16 text-center text-gray-500 text-sm no-print">
            <p>Thank you for your business!</p>
            <div class="mt-4 space-x-4">
                 <button id="print-btn" class="bg-green-500 text-white font-semibold py-2 px-6 rounded-md hover:bg-green-600 transition duration-300">
                    Print / Save as PDF
                </button>
                <button id="submit-btn" class="bg-indigo-500 text-white font-semibold py-2 px-6 rounded-md hover:bg-indigo-600 transition duration-300">
                    Submit Data
                </button>
            </div>
            <div id="submit-message" class="mt-4 text-sm"></div>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const itemsContainer = document.getElementById('invoice-items');
            const addItemBtn = document.getElementById('add-item-btn');
            const subtotalEl = document.getElementById('subtotal');
            const taxRateEl = document.getElementById('tax-rate');
            const grandTotalEl = document.getElementById('grand-total');
            const invoiceForm = document.getElementById('invoice-form');
            const submitBtn = document.getElementById('submit-btn');
            const printBtn = document.getElementById('print-btn'); // Get the print button
            const submitMessage = document.getElementById('submit-message');

            // Set default dates
            const today = new Date();
            const isoDate = today.toISOString().split('T')[0];
            document.getElementById('invoice-date').value = isoDate;
            document.getElementById('service-start').value = isoDate;
            document.getElementById('service-end').value = isoDate;

            const createItemRow = () => {
                const row = document.createElement('tr');
                row.className = 'border-b border-gray-200 item-row';
                row.innerHTML = `
                    <td class="p-2">
                        <select class="w-full p-1 border rounded-md service-item">
                            <option value="" disabled selected>Select a service...</option>
                            <optgroup label="Pre-Production Labor"><option>A. Audio Mixer</option><option>A. Cam Operator</option><option>A. Director</option><option>A. Producer</option><option>A. Producer - Associate Producer</option><option>A. Producer - Creative Producer</option><option>A. Producer - Executive Producer</option><option>A. Production Coordinator / PA</option><option>A. Production Manager</option><option>A. Assistant Camera</option><option>A. Assistant Director</option><option>A. Best Boy Electric</option><option>A. Gaffer</option><option>A. Best Boy Grip</option><option>A. Key Grip</option><option>A. Director of Photography</option><option>A. Director of Photography - Commercial</option><option>A. Director - Commercial</option><option>A. DIT</option><option>A. Hair & Makeup Artist</option><option>A. Jib</option><option>A. Jib Assist</option><option>A. Live Audio Mixer</option><option>A. Livestream Graphic Tech</option><option>A. Photographer</option><option>A. Photographer - Commercial</option><option>A. Producer - Field</option><option>A. Production Designer</option><option>A. Production Sound Engineer</option><option>A. Script Supervisor</option><option>A. Set Medic</option><option>A. Steadicam</option><option>A. Swing</option><option>A. Technical Director</option><option>A. Teleprompter Operator</option><option>A. VTR Operator</option><option>A. 2nd Assistant Camera</option><option>A. Electric</option><option>A. Grip</option><option>A. Hair and Makeup Assistant</option><option>A. Location Scout</option><option>A. 2nd Assistant Director</option><option>A. Teamsters / Driver</option><option>A. Pre-Production Fringe</option></optgroup>
                            <optgroup label="Shoot Labor"><option>B. Audio Mixer</option><option>B. Cam Operator</option><option>B. Director</option><option>B. Producer</option><option>B. Producer - Associate Producer</option><option>B. Producer - Creative Producer</option><option>B. Producer - Executive Producer</option><option>B. Production Coordinator / PA</option><option>B. Production Manager</option><option>B. Assistant Camera</option><option>B. Assistant Director</option><option>B. Best Boy Electric</option><option>B. Gaffer</option><option>B. Best Boy Grip</option><option>B. Key Grip</option><option>B. Director of Photography</option><option>B. Director of Photography - Commercial</option><option>B. Director - Commercial</option><option>B. DIT</option><option>B. Hair & Makeup Artist</option><option>B. Jib</option><option>B. Jib Assist</option><option>B. Live Audio Mixer</option><option>B. Livestream Graphic Tech</option><option>B. Photographer</option><option>B. Photographer - Commercial</option><option>B. Producer - Field</option><option>B. Production Designer</option><option>B. Production Sound Engineer</option><option>B. Script Supervisor</option><option>B. Set Medic</option><option>B. Steadicam</option><option>B. Swing</option><option>B. Technical Director</option><option>B. Teleprompter Operator</option><option>B. VTR Operator</option><option>B. 2nd Assistant Camera</option><option>B. Electric</option><option>B. Grip</option><option>B. Hair and Makeup Assistant</option><option>B. Location Scout</option><option>B. 2nd Assistant Director</option><option>B. Teamsters / Driver</option><option>B. Shoot Fringe</option></optgroup>
                            <optgroup label="Prep & Wrap Expenses"><option>C. Craft Services</option><option>C. Meals - Per Diem</option><option>C. Hotels</option><option>C. Taxi & Rideshare</option><option>C. Car Rental</option><option>C. Casting Director</option></optgroup>
                            <optgroup label="Location Expenses"><option>D. Location Rental</option><option>D. Drone Permit</option><option>D. Set Security</option><option>D. Cargo Van / Production Trucking / Camera Truck</option><option>D. Car Rental</option><option>D. Other Vehicles</option><option>D. Parking/Tolls/Gas</option><option>D. Baggage Fees</option><option>D. Airfare</option><option>D. Hotel</option><option>D. Per Diems</option><option>D. Site Rep</option><option>D. Catering</option><option>D. Craft Services</option><option>D. Taxi & Rideshare</option><option>D. Kit Rental</option></optgroup>
                            <optgroup label="Props and Wardrobe"><option>E. Prop Rental</option><option>E. Prop Purchase</option><option>E. Prop Fabrication</option><option>E. Wardrobe Rental</option><option>E. Wardrobe Purchase</option></optgroup>
                            <optgroup label="Studio Costs"><option>F. Rental For Build Days</option><option>F. Build OT Hours</option><option>F. Rental for Pre-Light Days</option><option>F. Pre-Light OT Hours</option><option>F. Rental for Shoot Days</option><option>F. Shoot OT Hours</option><option>F. Rental For Strike Days</option><option>F. Strike OT Hours</option><option>F. Generator & Operator</option><option>F. Stage Manager/Studio Security</option><option>F. Power Charges</option><option>F. Misc. Studio Charges</option><option>F. Crew Parking</option><option>F. Condor/Scissor Lift</option><option>F. Steeldeck</option></optgroup>
                            <optgroup label="Art Department Labor"><option>G. Production Designer</option><option>G. Art Department Coordinator</option><option>G. Prop Master</option><option>G. Assistant Props</option><option>G. Swing</option><option>G. Leadperson</option><option>G. Set Designer</option><option>G. Set Dresser</option><option>G. Wardrobe Stylist</option><option>G. Wardrobe Assistant</option><option>G. Scenics</option><option>G. Grips / Riggers</option><option>G. Art Department Fringe</option></optgroup>
                            <optgroup label="Art Department Expenses"><option>H. Set Dressing Rentals</option><option>H. Set Dressing Purchases</option><option>H. Art Department Prod Supplies</option><option>H. Art Department Kit Rentals</option><option>H. Special Effects Rentals</option><option>H. Art Department Trucking</option><option>H. Outside Construction</option><option>H. Car Prep</option><option>H. Art Department Meals</option><option>H. Messengers/Deliveries</option></optgroup>
                            <optgroup label="Equipment Rentals"><option>I. Camera Rental</option><option>I. Sound Rental</option><option>I. Lighting Rental</option><option>I. Grip Rental</option><option>I. Generator Rental</option><option>I. Crane Rental</option><option>I. VTR Rental</option><option>I. Walkie Talkie Rental</option><option>I. Dolly Rental</option><option>I. Helicopter</option><option>I. Production Supplies</option><option>I. Jib Arm</option><option>I. Crane Head</option><option>I. Camera Accessories</option><option>I. Expendables</option><option>I. Lenses</option><option>I. Cinedrives</option></optgroup>
                            <optgroup label="Media"><option>J. Media / Drives</option><option>J. Film</option><option>J. Transcode / Transfer</option><option>J. Process</option><option>J. Dailies</option></optgroup>
                            <optgroup label="Miscellaneous Production Cost"><option>K. Insurance</option><option>K. Misc Other Production Costs</option><option>K. Specialty Service</option></optgroup>
                            <optgroup label="Talent Expenses"><option>L. Talent Fee</option><option>L. Talent Flights</option><option>L. Talent Hotels</option><option>L. Talent Meals</option><option>L. Talent Manager</option><option>L. Other Talent Related Expenses</option><option>L. Agency Fees</option></optgroup>
                            <optgroup label="Post Production Labor"><option>M. Editor</option><option>M. Editor - Assistant</option><option>M. Editor - Senior</option><option>M. CMS Manager</option><option>M. Animator (2D)</option><option>M. Animator - Senior (3D)</option><option>M. Producer - Post</option><option>M. VFX Supervisor</option><option>M. Post Audio Engineer</option><option>M. Colorist</option><option>M. VO Artist</option><option>M. Graphic Designer</option><option>M. Graphic Designer - Senior</option><option>M. Animation Supervisor</option><option>M. Post Production Supervisor</option><option>M. Post Production Fringe</option></optgroup>
                            <optgroup label="Post Production Expenses"><option>N. Music Clearance</option><option>N. Music Library Fees</option><option>N. Stock Image Licensing</option><option>N. Stock Video Licensing</option><option>N. Transcriptions and Translations</option></optgroup>
                            <optgroup label="Creative and Strategic Services"><option>O. Art Director</option><option>O. Art Director - Senior</option><option>O. Copywriter</option><option>O. Copywriter - Senior</option><option>O. Creative Director</option><option>O. Creative Director - Associate</option><option>O. Graphic Designer</option><option>O. Graphic Designer - Senior</option><option>O. UI/UX Designer</option><option>O. Experiential Designer</option><option>O. Experiential Producer</option><option>O. Illustrator</option><option>O. Strategy - Creative Strategist</option><option>O. Strategy - Strategy Director</option><option>O. Storyboard Artist</option><option>O. Group Creative Director</option><option>O. Creative and Strategic Services Fringe</option></optgroup>
                            <optgroup label="Creative and Strategic Services Expenses"><option>P. Airfare</option><option>P. Hotel</option><option>P. Per Diems</option><option>P. Taxi & Rideshare</option><option>P. Car Rental</option><option>P. Catering</option><option>P. Fabrication</option><option>P. Furniture and Decor</option><option>P. Signage and Print</option><option>P. Shipping and Postage</option></optgroup>
                            <optgroup label="Account and Project Management"><option>Q. Account Manager</option><option>Q. Account Director</option><option>Q. Project Manager</option><option>Q. Project Manager - Senior</option><option>Q. Supervising Project Manager</option></optgroup>
                            <optgroup label="Account and Project Management Expenses"><option>R. Airfare</option><option>R. Hotel</option><option>R. Per Diems</option><option>R. Taxi & Rideshare</option><option>R. Car Rental</option></optgroup>
                        </select>
                    </td>
                    <td class="p-2"><input type="text" placeholder="######" maxlength="6" oninput="this.value = this.value.replace(/[^0-9]/g, '')" class="w-full p-1 border rounded-md text-center job-code"></td>
                    <td class="p-2"><input type="number" placeholder="0" value="0" min="0" step="0.5" class="w-full p-1 border rounded-md text-center quantity"></td>
                    <td class="p-2"><input type="number" placeholder="0.00" min="0" step="0.01" class="w-full p-1 border rounded-md text-right rate"></td>
                    <td class="p-2 text-right font-semibold amount">$0.00</td>
                    <td class="p-2 text-center no-print"><button class="text-red-500 hover:text-red-700 remove-item-btn">&times;</button></td>
                `;
                itemsContainer.appendChild(row);
            };

            const calculateTotals = () => {
                let subtotal = 0;
                document.querySelectorAll('.item-row').forEach(row => {
                    const quantity = parseFloat(row.querySelector('.quantity').value) || 0;
                    const rate = parseFloat(row.querySelector('.rate').value) || 0;
                    const amount = quantity * rate;
                    row.querySelector('.amount').textContent = `$${amount.toFixed(2)}`;
                    subtotal += amount;
                });

                const taxRate = parseFloat(taxRateEl.value) || 0;
                const taxAmount = subtotal * (taxRate / 100);
                const grandTotal = subtotal + taxAmount;

                subtotalEl.textContent = `$${subtotal.toFixed(2)}`;
                grandTotalEl.textContent = `$${grandTotal.toFixed(2)}`;
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                submitBtn.disabled = true;
                submitMessage.textContent = 'Submitting...';
                submitMessage.classList.remove('text-red-500', 'text-green-500');

                const invoiceData = {
                    vendorName: document.getElementById('vendor-name').value,
                    vendorAddress: document.getElementById('vendor-address').value,
                    vendorCity: document.getElementById('vendor-city').value,
                    vendorEmail: document.getElementById('vendor-email').value,
                    clientName: document.getElementById('client-name').value,
                    hiringManager: document.getElementById('hiring-manager').value,
                    hiringManagerEmail: document.getElementById('hiring-manager-email').value,
                    invoiceNumber: document.getElementById('invoice-number').value,
                    invoiceDate: document.getElementById('invoice-date').value,
                    payTerms: document.getElementById('pay-terms').value,
                    poNumber: document.getElementById('po-number').value,
                    serviceStart: document.getElementById('service-start').value,
                    serviceEnd: document.getElementById('service-end').value,
                    subtotal: subtotalEl.textContent,
                    taxRate: taxRateEl.value,
                    grandTotal: grandTotalEl.textContent,
                    items: []
                };

                document.querySelectorAll('.item-row').forEach(row => {
                    invoiceData.items.push({
                        serviceItem: row.querySelector('.service-item').value,
                        jobCode: row.querySelector('.job-code').value,
                        hours: row.querySelector('.quantity').value,
                        rate: row.querySelector('.rate').value,
                        amount: row.querySelector('.amount').textContent
                    });
                });

                // !!! IMPORTANT !!! - PASTE YOUR SCRIPT URL HERE
                const scriptURL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE';

                fetch(scriptURL, { method: 'POST', body: JSON.stringify(invoiceData) })
                    .then(response => {
                        submitMessage.textContent = 'Data submitted successfully!';
                        submitMessage.classList.add('text-green-500');
                        submitBtn.disabled = false;
                    })
                    .catch(error => {
                        submitMessage.textContent = 'Error! Data not submitted.';
                        submitMessage.classList.add('text-red-500');
                        console.error('Error!', error.message);
                        submitBtn.disabled = false;
                    });
            };

            addItemBtn.addEventListener('click', createItemRow);
            submitBtn.addEventListener('click', handleSubmit);
            printBtn.addEventListener('click', () => { // Add event listener for print button
                window.print();
            });

            invoiceForm.addEventListener('input', (e) => {
                if (e.target.classList.contains('quantity') || e.target.classList.contains('rate') || e.target.id === 'tax-rate') {
                    calculateTotals();
                }
                if (e.target.classList.contains('job-code')) {
                    const jobCodeInput = e.target;
                    const value = jobCodeInput.value;
                    if (value.length > 0 && value.length < 6) {
                        jobCodeInput.classList.add('text-red-500');
                    } else {
                        jobCodeInput.classList.remove('text-red-500');
                    }
                }
            });
           
            invoiceForm.addEventListener('click', (e) => {
                if (e.target.classList.contains('remove-item-btn')) {
                    e.target.closest('.item-row').remove();
                    calculateTotals();
                }
            });

            createItemRow();
            calculateTotals();
        });
    </script>
</body>
</html>